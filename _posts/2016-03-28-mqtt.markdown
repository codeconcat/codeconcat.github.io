---
layout   : post
title    : MQTT
date     : 2016-04-02 11:52:58
subtitle : "Messaging protocol - â€œmachine-to-machineâ€ and â€œInternet of Thingsâ€ world ğŸ‘ this."
author   : "MeoBeoI"
header-img: "http://iotworm.com/wp-content/uploads/2016/03/simoniot.jpg"
---

### Báº¡n Ä‘Ã£ sá»­ dá»¥ng Mqtt rá»“i !
Khi "trÃ² chuyá»‡n" vá»›i "báº¡n bÃ¨" trÃªn Facebook Messenger, báº¡n nghÄ© nÃ³ cÅ©ng dÃ¹ng socket, nhÆ° ngÃ n ngÃ n bÃ i hÆ°á»›ng dáº«n vá» lÃ m chat apps Ä‘áº§y ráº«y trÃªn máº¡ng, nhÆ°ng **nope**, FB Message dÃ¹ng MQTT [read more](https://www.facebook.com/notes/facebook-engineering/building-facebook-messenger/10150259350998920/)

### I. MQTT lÃ  gÃ¬ ?
Mqtt lÃ  **connectivity protocol** Ä‘Æ°á»£c thiáº¿t káº¿ trÃªn cÆ¡ cháº¿ **pub/sub** dÃ nh cho <strong><em>low-bandwidth, high latency networks</em></strong> ( ra Ä‘á»i cuá»‘i nhá»¯ng nÄƒm 90, Ä‘áº§u nhá»¯ng nÄƒm 2000 :D, thá»i cÃ²n dial up Ã² Ã­ e Ã­ áº¹ ), giá» trá»Ÿ thÃ nh má»™t trong nhá»¯ng phÆ°Æ¡ng thá»©c káº¿t ná»‘i hiá»‡u quáº£ dÃ nh cho **Internet of Things**.

### II. Mqtt cÃ³ thá»ƒ lÃ m gÃ¬
+ Realtime communication
+ Control

##### Advantages :
+ **Dead Simple** vá»›i cÆ¡ cháº¿ `pub/sub`
+ **Extremely Fast** - do Ä‘Æ°á»£c thiáº¿t káº¿ dÃ nh cho low-bandwidth, high latency networks mÃ .
+ Sá»­ dá»¥ng Ã­t bandwidth, battery ( cho IoT mÃ  ) <~~ cÃ¡i nÃ y sáº½ quan trá»ng náº¿u báº¡n dÃ¹ng cho Mobile app, sensor <~~ má»™t trong nhá»¯ng lÃ½ do FB quyáº¿t Ä‘á»‹nh sá»­ dá»¥ng MQTT cho FB Mess.

### III. How to use it
CÆ¡ báº£n sáº½ cÃ³ cÃ¡c thÃ nh pháº§n sau :
+ **Mqtt Broker** : Ä‘Ã¢y giá»‘ng nhÆ° Message server
+ **Mqtt client** : Ä‘Ã¢y gá»“m cÃ¡c thiáº¿t bá»‹ sá»­ dá»¥ng mqtt
Khi cÃ³ 1 client publish message vÃ o `topic` nÃ o Ä‘Ã³ thÃ¬ táº¥t cáº£ cÃ¡c client `subscribe` vÃ o topic Ä‘Ã³ sáº½ nháº­n Ä‘Æ°á»£c.

<script src="https://gist.github.com/MeoBeoI/60b9fbbdb5e3ad2f6567.js"></script>

- **client** connect vÃ o broker test cá»§a *mosquitto* má»™t trong nhá»¯ng broker, ngoÃ i ra cÃ²n cÃ³ RabitMQ, HiveMQ, vÃ  con mÃ¨o cute Mosca
- Khi Ä‘Ã£ `on connect` nÃ³ sáº½ `subscribe` vÃ o topic `chatroom` vÃ  Ä‘á»£i ...
- Publish 1 message báº±ng `client.publish('chatroom', 'message')`
- `on message` sáº½ cháº¡y cÃ¡i callback kia khi cÃ³ message Ä‘áº¿n, message á»Ÿ dáº¡ng `Buffer` nÃªn pháº£i `.toString()` Ä‘á»ƒ chuyá»ƒn vá» String, náº¿u message Ä‘Ã³ lÃ  `Object` thÃ¬ `JSON.parse(message.toString())` nhÃ©.

#### Tham kháº£o :
+ [Mqtt.org](http://mqtt.org)
+ [Mosquitto Broker](http://mosquitto.org)
